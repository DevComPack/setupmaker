<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project name="Create Runnable Jar for Project devcompack with Jar-in-Jar Loader" default="create_run_jar" basedir=".">
    <!-- ANT 1.7 is required -->
	
    <description>
        DevComPack Setup Maker Ant build file
    </description>
	
	<!-- set global properties for this build -->
	<property name="version" value="1.0.3"/>
	<property name="lib" location="${basedir}/lib"/>
	<property name="releases" value="${basedir}/releases"/>
	<property name="jar_name" value="DCP-SNAPSHOT.jar"/>
	<property name="jar_file" value="${basedir}/${jar_name}"/>
	<property name="current_release" value="${releases}/DCP_${version}/"/>
	
	<target name="init">
		<tstamp/>
		<mkdir dir="${releases}"/>
	</target>
	
    <target name="create_run_jar" depends="init" description="create runnable jar file">
        <jar destfile="${jar_file}">
            <manifest>
                <attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader"/>
                <attribute name="Rsrc-Main-Class" value="dcp.main.gui.pivot.Master"/>
                <attribute name="Class-Path" value="."/>
                <attribute name="Rsrc-Class-Path" value="./ truezip-samples-7.7.1-jar-with-dependencies.jar ant.jar staxmate-2.2.0.jar stax2-api-3.1.1.jar woodstox-core-asl-4.1.5.jar compiler.jar installer.jar jakarta-regexp-1.3.jar pivot-charts-2.0.3.jar pivot-core-2.0.3.jar pivot-wtk-2.0.3.jar pivot-wtk-terra-2.0.3.jar ant-launcher.jar ant-apache-log4j.jar ant-apache-regexp.jar ant-contrib.jar izevent.jar standalone-compiler.jar uninstaller-ext.jar uninstaller.jar bsf.jar kunststoff.jar liquidlnf.jar looks.jar metouia.jar nimbus.jar substance.jar json-simple-1.1.1.jar jsch-0.1.50.jar"/>
            </manifest>
            <fileset dir="${basedir}/bin"/>
            <zipfileset src="${lib}/jar-in-jar-loader.zip"/>
            <zipfileset dir="${lib}" includes="truezip-samples-7.7.1-jar-with-dependencies.jar"/>
            <zipfileset dir="${lib}\ant" includes="ant.jar"/>
            <zipfileset dir="${lib}" includes="staxmate-2.2.0.jar"/>
            <zipfileset dir="${lib}" includes="stax2-api-3.1.1.jar"/>
            <zipfileset dir="${lib}" includes="woodstox-core-asl-4.1.5.jar"/>
            <zipfileset dir="${lib}\izpack" includes="compiler.jar"/>
            <zipfileset dir="${lib}\izpack" includes="installer.jar"/>
            <zipfileset dir="${lib}\izpack" includes="jakarta-regexp-1.3.jar"/>
            <zipfileset dir="${lib}\pivot" includes="pivot-charts-2.0.3.jar"/>
            <zipfileset dir="${lib}\pivot" includes="pivot-core-2.0.3.jar"/>
            <zipfileset dir="${lib}\pivot" includes="pivot-wtk-2.0.3.jar"/>
            <zipfileset dir="${lib}\pivot" includes="pivot-wtk-terra-2.0.3.jar"/>
            <zipfileset dir="${lib}\ant" includes="ant-launcher.jar"/>
            <zipfileset dir="${lib}\ant" includes="ant-apache-log4j.jar"/>
            <zipfileset dir="${lib}\ant" includes="ant-apache-regexp.jar"/>
            <zipfileset dir="${lib}\ant" includes="ant-contrib.jar"/>
            <zipfileset dir="${lib}\izpack" includes="izevent.jar"/>
            <zipfileset dir="${lib}\izpack" includes="standalone-compiler.jar"/>
            <zipfileset dir="${lib}\izpack" includes="uninstaller-ext.jar"/>
            <zipfileset dir="${lib}\izpack" includes="uninstaller.jar"/>
            <zipfileset dir="${lib}\izpack" includes="bsf.jar"/>
            <zipfileset dir="${lib}\izpack" includes="kunststoff.jar"/>
            <zipfileset dir="${lib}\izpack" includes="liquidlnf.jar"/>
            <zipfileset dir="${lib}\izpack" includes="looks.jar"/>
            <zipfileset dir="${lib}\izpack" includes="metouia.jar"/>
            <zipfileset dir="${lib}\izpack" includes="nimbus.jar"/>
            <zipfileset dir="${lib}\izpack" includes="substance.jar"/>
            <zipfileset dir="${lib}\json" includes="json-simple-1.1.1.jar"/>
            <zipfileset dir="${lib}\web" includes="jsch-0.1.50.jar"/>
        </jar>
		<echo message="${jar_file} file created."/>
    </target>
	
	<target name="prepare_release" description="prepare release archive" >
		<mkdir dir="${current_release}"/>
		<zip destfile="${current_release}/DCP-${version}.zip">
			<fileset dir="${basedir}" includes="lib/dcp/"/>
			<fileset dir="${basedir}" includes="res/bat/ res/langpacks/ res/utils/ res/xml/"/>
			<zipfileset dir="${basedir}" includes="${jar_name}" fullpath="DCP-${version}.jar"/>
			<zipfileset dir="${basedir}" includes="settings.json" fullpath="settings.json"/>
			<zipfileset dir="${basedir}" includes="res/Readme.txt" fullpath="Readme.txt"/>
			<zipfileset dir="${basedir}" includes="res/license.txt" fullpath="license.txt"/>
			<zipfileset dir="${basedir}" includes="res/release_notes.txt" fullpath="change_log.txt"/>
		</zip>
	</target>
	
</project>
